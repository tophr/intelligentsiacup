(function(){var $,t,e;$=jQuery,e=function(){function t(){this.fileLoadingImage="/images/lightbox/loading.gif",this.fileCloseImage="/images/lightbox/close.png",this.resizeDuration=700,this.fadeDuration=500,this.labelImage="Image",this.labelOf="of"}return t}(),t=function(){function t(t){this.options=t,this.album=[],this.currentImageIndex=void 0,this.init()}return t.prototype.init=function(){return this.enable(),this.build()},t.prototype.enable=function(){var t=this;return $("body").on("click","a[rel^=lightbox], area[rel^=lightbox]",function(e){return t.start($(e.currentTarget)),!1})},t.prototype.build=function(){var t,e=this;$("<div>",{id:"lightboxOverlay"}).after($("<div/>",{id:"lightbox"}).append($("<div/>",{class:"lb-outerContainer"}).append($("<div/>",{class:"lb-container"}).append($("<img/>",{class:"lb-image"}),$("<div/>",{class:"lb-nav"}).append($("<a/>",{class:"lb-prev"}),$("<a/>",{class:"lb-next"})),$("<div/>",{class:"lb-loader"}).append($("<a/>",{class:"lb-cancel"}).append($("<img/>",{src:this.options.fileLoadingImage}))))),$("<div/>",{class:"lb-dataContainer"}).append($("<div/>",{class:"lb-data"}).append($("<div/>",{class:"lb-details"}).append($("<span/>",{class:"lb-caption"}),$("<span/>",{class:"lb-number"})),$("<div/>",{class:"lb-closeContainer"}).append($("<a/>",{class:"lb-close"}).append($("<img/>",{src:this.options.fileCloseImage}))))))).appendTo($("body")),$("#lightboxOverlay").hide().on("click",function(t){return e.end(),!1}),t=$("#lightbox"),t.hide().on("click",function(t){return"lightbox"===$(t.target).attr("id")&&e.end(),!1}),t.find(".lb-outerContainer").on("click",function(t){return"lightbox"===$(t.target).attr("id")&&e.end(),!1}),t.find(".lb-prev").on("click",function(t){return e.changeImage(e.currentImageIndex-1),!1}),t.find(".lb-next").on("click",function(t){return e.changeImage(e.currentImageIndex+1),!1}),t.find(".lb-loader, .lb-close").on("click",function(t){return e.end(),!1})},t.prototype.start=function(t){var e,i,n,a,o,r,s,l,h;if($(window).on("resize",this.sizeOverlay),$("select, object, embed").css({visibility:"hidden"}),$("#lightboxOverlay").width($(document).width()).height($(document).height()).fadeIn(this.options.fadeDuration),this.album=[],o=0,"lightbox"===t.attr("rel"))this.album.push({link:t.attr("href"),title:t.attr("title")});else for(h=$(t.prop("tagName")+'[rel="'+t.attr("rel")+'"]'),a=0,l=h.length;a<l;a++)n=h[a],this.album.push({link:$(n).attr("href"),title:$(n).attr("title")}),$(n).attr("href")===t.attr("href")&&(o=a);i=$(window),s=i.scrollTop()+i.height()/10,r=i.scrollLeft(),e=$("#lightbox"),e.css({top:s+"px",left:r+"px"}).fadeIn(this.options.fadeDuration),this.changeImage(o)},t.prototype.changeImage=function(t){var e,i,n,a=this;this.disableKeyboardNav(),i=$("#lightbox"),e=i.find(".lb-image"),this.sizeOverlay(),$("#lightboxOverlay").fadeIn(this.options.fadeDuration),$(".loader").fadeIn("slow"),i.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),i.find(".lb-outerContainer").addClass("animating"),n=new Image,n.onload=function(){return e.attr("src",a.album[t].link),e.width=n.width,e.height=n.height,a.sizeContainer(n.width,n.height)},n.src=this.album[t].link,this.currentImageIndex=t},t.prototype.sizeOverlay=function(){return $("#lightboxOverlay").width($(document).width()).height($(document).height())},t.prototype.sizeContainer=function(t,e){var i,n,a,o,r,s,l,h,d,c,u,b=this;n=$("#lightbox"),a=n.find(".lb-outerContainer"),u=a.outerWidth(),c=a.outerHeight(),i=n.find(".lb-container"),l=parseInt(i.css("padding-top"),10),s=parseInt(i.css("padding-right"),10),o=parseInt(i.css("padding-bottom"),10),r=parseInt(i.css("padding-left"),10),d=t+r+s,h=e+l+o,d!==u&&h!==c?a.animate({width:d,height:h},this.options.resizeDuration,"swing"):d!==u?a.animate({width:d},this.options.resizeDuration,"swing"):h!==c&&a.animate({height:h},this.options.resizeDuration,"swing"),setTimeout(function(){n.find(".lb-dataContainer").width(d),n.find(".lb-prevLink").height(h),n.find(".lb-nextLink").height(h),b.showImage()},this.options.resizeDuration)},t.prototype.showImage=function(){var t;t=$("#lightbox"),t.find(".lb-loader").hide(),t.find(".lb-image").fadeIn("slow"),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},t.prototype.updateNav=function(){var t;t=$("#lightbox"),t.find(".lb-nav").show(),this.currentImageIndex>0&&t.find(".lb-prev").show(),this.currentImageIndex<this.album.length-1&&t.find(".lb-next").show()},t.prototype.updateDetails=function(){var t,e=this;t=$("#lightbox"),void 0!==this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title&&t.find(".lb-caption").html(this.album[this.currentImageIndex].title).fadeIn("fast"),this.album.length>1?t.find(".lb-number").html(this.options.labelImage+" "+(this.currentImageIndex+1)+" "+this.options.labelOf+"  "+this.album.length).fadeIn("fast"):t.find(".lb-number").hide(),t.find(".lb-outerContainer").removeClass("animating"),t.find(".lb-dataContainer").fadeIn(this.resizeDuration,function(){return e.sizeOverlay()})},t.prototype.preloadNeighboringImages=function(){var t,e;this.album.length>this.currentImageIndex+1&&(t=new Image,t.src=this.album[this.currentImageIndex+1].link),this.currentImageIndex>0&&(e=new Image,e.src=this.album[this.currentImageIndex-1].link)},t.prototype.enableKeyboardNav=function(){$(document).on("keyup.keyboard",$.proxy(this.keyboardAction,this))},t.prototype.disableKeyboardNav=function(){$(document).off(".keyboard")},t.prototype.keyboardAction=function(t){var e,i,n,a,o;e=27,i=37,n=39,o=t.keyCode,a=String.fromCharCode(o).toLowerCase(),o===e||a.match(/x|o|c/)?this.end():"p"===a||o===i?0!==this.currentImageIndex&&this.changeImage(this.currentImageIndex-1):"n"!==a&&o!==n||this.currentImageIndex!==this.album.length-1&&this.changeImage(this.currentImageIndex+1)},t.prototype.end=function(){return this.disableKeyboardNav(),$(window).off("resize",this.sizeOverlay),$("#lightbox").fadeOut(this.options.fadeDuration),$("#lightboxOverlay").fadeOut(this.options.fadeDuration),$("select, object, embed").css({visibility:"visible"})},t}(),$(function(){var i,n;return n=new e,i=new t(n)})}).call(this);